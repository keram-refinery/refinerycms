<%%= form_for [refinery, :admin_<%= namespacing.underscore %>, @<%= singular_name %>],
              html: { data: { remote: true }} do |f| %>
  <%%= render '/refinery/admin/error_messages',
              object: f.object,
              include_object_name: true %>

<% if localized? -%>
  <%%= render('/refinery/admin/locale_picker',
              (@<%= singular_name %>.new_record? ?
                { url: 'new_admin_<%= namespacing.underscore %>_<%= singular_name %>_path' } :
                { url: 'edit_admin_<%= namespacing.underscore %>_<%= singular_name %>_path',
                  url_options: { id: @<%= singular_name %>.id } })
            ) if Refinery::I18n.frontend_locales.many? %>
<% end -%>

<% attributes.each_with_index do |attribute, index| -%>
<% if attribute.type == :image %>
  <div class="field">
    <%%= f.label :<%= attribute.name %> %>
    <%%= render '/refinery/admin/image_picker',
               f: f,
               field: :<%= "#{attribute.name}_id".gsub("_id_id", "_id") %>,
               image: @<%= singular_name %>.<%= attribute.name.gsub("_id", "") %> %>
  </div>

<% elsif attribute.type == :resource -%>
  <div class="field">
    <%%= f.label :<%= attribute.name %> %>
    <%%= render '/refinery/admin/resource_picker',
               f: f,
               field: :<%= "#{attribute.name}_id".gsub("_id_id", "_id") %>,
               resource: @<%= singular_name %>.<%= attribute.name.gsub("_id", "") %> %>
  </div>

<% elsif attribute.field_type == :text_area -%>
  <div class="field">
    <%%= f.label :<%= attribute.name %> %>
    <%%= render '/refinery/admin/wysiwyg',
                f: f,
                field: :<%= attribute.name %> -%>
  </div>

<% else -%>
  <div class="field">
    <%%= f.label :<%= attribute.name %> %>
    <%%= f.<%= attribute.field_type %> :<%= attribute.name %><%= ", class: 'larger widest'" if (index == 0 && attribute.field_type == :text_field) %><%= ", checked: @#{singular_name}[:#{attribute.name}]" if attribute.field_type == :check_box %> %>
  </div>

<% end -%>
<% end -%>
  <%%= render '/refinery/admin/form_actions', f: f,
             delete_title: t('delete', scope: 'refinery.<%= plural_name %>.admin.<%= plural_name %>.<%= singular_name %>'),
             delete_confirmation: t('message', scope: 'refinery.admin.delete'<% if title_attribute.present? %>, title: @<%= singular_name %>.<%= title_attribute_name %><% end %>) %>
<%% end -%>
