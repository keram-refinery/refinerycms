<%
  admin_path = '#{Refinery::Core.backend_route}'
  admin_path << "/#{namespacing.underscore}" if namespacing.underscore != plural_name
-%>
Refinery::Core::Engine.routes.draw do
  # Frontend routes
  namespace :<%= namespacing.underscore %> do
    resources :<%= plural_name %><%= ", :path => ''" if namespacing.underscore == plural_name %>, :only => [:new, :create] do
      collection do
        get :thank_you
      end
    end
  end

  # Admin routes
  namespace :admin, :path => "<%= admin_path %>" do
    namespace :<%= plural_name %>, :path => '' do
      resources :<%= plural_name %>, :only => [:index, :show, :destroy] <% if @includes_spam %> do
        collection do
          get :spam
        end
        member do
          get :toggle_spam
        end
      end<% end %>

      resources :settings, :only => [:edit, :update]
    end
  end
end
