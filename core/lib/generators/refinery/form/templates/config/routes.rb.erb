plugin = Refinery::Plugins['<%= extension_name -%>']
if plugin
  Refinery::Core::Engine.routes.draw do
    # Frontend routes
    if plugin.page.present? && Refinery::Pages.marketable_urls
      Globalize.with_locales plugin.page.translated_locales do |locale|
        get plugin.page.nested_path,
          to: '<%= namespacing.underscore %>/<%= plural_name %>#new',
          as: "new_<%= namespacing.underscore %>_<%= singular_name %>_#{locale}"
        post plugin.page.nested_path,
          to: '<%= namespacing.underscore %>/<%= plural_name %>#create',
          as: "<%= namespacing.underscore %>_<%= plural_name %>_#{locale}"
      end
    else
      namespace :<%= namespacing.underscore %> do
        resources :<%= plural_name %><%= ", path: ''" if namespacing.underscore == plural_name %>, only: [:index, :new, :create] do
          collection do
            get :thank_you
          end
        end
      end
    end

    # Admin routes
    namespace :admin, path: Refinery::Core.backend_route do
      namespace :<%= plural_name %> do
        resources :<%= plural_name %>, only: [:index, :show, :destroy] <% if includes_spam? %> do
          collection do
            get :spam
          end
          member do
            get :toggle_spam
          end
        end<% end %>

        resources :settings, only: [:edit, :update]
      end
    end
  end
end
