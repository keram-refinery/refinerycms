<%
  unless (hide_submit ||= false)
    submit_button_text  ||= t('.save')
    submit_button_class ||= 'submit-button'
    submit_button_title ||= nil
  end

  hide_cancel = true unless defined?(hide_cancel).presence

  unless hide_cancel
    cancel_button_text ||= t('.cancel')
    unless defined?(cancel_title)
      cancel_title = t('.cancel_lose_changes')
    end
    cancel_button_class ||= 'cancel-button'
    cancel_url ||= (((back = url_for(:back)).include?('javascript') or action_name =~ /^(create|update)$/) ? refinery.send(Refinery.route_for_model(f.object.class, plural: true)) : back)
  end

  unless defined?(hide_delete).presence
    hide_delete = (f.object.nil? or (f.object.respond_to?(:persisted?) ? !f.object.persisted? : f.object.new_record?) or
                   (f.object.respond_to?(:deletable?) && !f.object.deletable?))
  end

  unless hide_delete
    delete_button_text  ||= t('.delete')
    delete_title        ||= nil
    delete_confirmation ||= nil
    delete_button_id    ||= 'delete-button'
    # we have to use eval rather than refinery.send because this url may not exist for HTTP GET
    delete_url          ||= eval("refinery.#{Refinery.route_for_model(f.object.class)}(#{f.object.id})")
  end
%>
<div class="form-actions clearfix">
  <div class="form-actions-left">
    <%= submit_tag submit_button_text,
                   name: nil,
                   class: "button #{submit_button_class}",
                   data: { disable_with: t('processing', scope: 'refinery.admin.form_actions') },
                   title: submit_button_title unless hide_submit %>

    <%= local_assigns[:before_cancel_button] %>

    <%= link_to(cancel_button_text, cancel_url,
                title: cancel_title,
                class: "button secondary-button #{cancel_button_class}") unless hide_cancel %>

    <%= local_assigns[:after_cancel_button] %>
  </div>
  <div class="form-actions-right">
    <%= local_assigns[:before_delete_button] %>
    <%= link_to(delete_button_text, delete_url,
                title: delete_title,
                id: delete_button_id,
                method: :delete,
                data: {
                  confirm: delete_confirmation
                },
                class: 'button confirm-delete danger-button nojs-hide') unless hide_delete %>
    <%= local_assigns[:after_delete_button] %>
  </div>
</div>
