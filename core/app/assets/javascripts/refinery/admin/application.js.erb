//= require jquery.min
//= require jquery_ujs
//= require vendor/jquery-ui.min.js
//= require turbolinks
//= require vendor/nestedsortables
//= require vendor/i18n
//= require refinery/i18n/refinery-en
//= require refinery/i18n/refinery-admin-en
//= require refinery/refinery.min
//= require refinery/admin/admin.min
<% ::Refinery::Core.admin_javascripts.each do |js| %>
<%= require_asset js %>
<% end %>

$(function () {
    var doc = $(document),
        ui = new refinery.admin.UserInterface().init($('body'));

    $.ajaxSettings.dataType = 'JSON';

    function reload () {
        ui.reload($('body', false));
        refinery.spinner.off();
    }

    doc.on('page:fetch', function () {
        $('.ui-dialog').remove();
        refinery.spinner.on();
    });

    doc.on('page:load', reload);
    doc.on('page:restore', reload);
});
