<% persisted = @resource.persisted? %>
<%= form_for @resource, :url => (persisted ? refinery.admin_resource_path(@resource) : refinery.admin_resources_path),
             :html => { :multipart => true },
             :as => 'resource' do |f| %>

  <%= render '/refinery/admin/error_messages',
             :object => @resource,
             :include_object_name => false %>

  <div class="field clearfix">
    <% if persisted %>
      <p>
        <%= link_to t('.download_current'), @resource.url,
                    :title => @resource.title %>
        <em><%= t('.or')%></em><%= t('.replace') %>
      </p>
    <% end %>
    <% # we must only hint at multiple when it's a *new* record otherwise update fails. %>
    <%= f.file_field :file, :required => true, :multiple => !persisted %>
    <label id="maximum-file-size">
      <%= t('.maximum_file_size', :bytes => number_to_human_size(Refinery::Resources.max_file_size)) %>
    </label>
  </div>

  <%= render '/refinery/admin/form_actions', :f => f,
             :hide_cancel => (action_name == 'insert'),
             :delete_title => t('delete', :scope => 'refinery.admin.resources'),
             :delete_confirmation => (t('message', :scope => 'refinery.admin.delete',
                                      :title => @resource.title) if persisted) %>

<% end %>
